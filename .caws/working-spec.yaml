id: PROJ-223
title: sterling-native
risk_tier: 2
mode: feature
change_budget:
  max_files: 25
  max_loc: 1000
blast_radius:
  modules:
    - kernel
    - harness
    - worlds
    - schemas
    - docs
  data_migration: false
operational_rollback_slo: 5m
threats:
  - v1 semantics re-entering v2 canonical docs or kernel
  - parallel implementations violating INV-CORE-12
  - trace format drift (code changes without schema version bump)
scope:
  in:
    - kernel/
    - harness/
    - worlds/
    - ml/
    - schemas/
    - docs/canonical/
    - docs/adr/
    - docs/policy/
    - docs/architecture/
    - docs/specs/
    - tests/
  out:
    - docs/reference/v1/
    - docs/ephemeral/
    - reference/v1_impl/
    - node_modules/
    - .caws/
invariants:
  - "Compilation boundary: compile(payload_bytes, schema_descriptor, registry) → CompilationResultV1 is the only entry point"
  - "ByteTrace is the canonical persisted trace (ADR 0002); StateGraph is derived"
  - "Neural is advisory only — no mutation, no operator creation, no precondition bypass (ADR 0003)"
  - "Operator taxonomy is S/M/P/K/C: Seek/Memorize/Perceive/Knowledge/Control (ADR 0004)"
  - "v1 is a test oracle, not a dependency — zero v1 imports in kernel build graph (ADR 0005)"
  - "DEV/CERTIFIED are the only governance modes"
  - "All docs outside reference/v1 must declare authority: front-matter field"
acceptance:
  - id: A1
    given: "a domain payload and schema descriptor"
    when: "compile() is called"
    then: "produces a ByteState with a deterministic digest (within Determinism Envelope)"
  - id: A2
    given: "a ByteTrace from an episode"
    when: "replay_verify() is called"
    then: "verdict matches original execution bit-for-bit"
  - id: A3
    given: "a CERTIFIED mode run with missing obligations"
    when: "execution reaches a gate"
    then: "run fails closed (no promotion-eligible artifacts emitted)"
non_functional:
  perf:
    api_p95_ms: 250
  security:
    - "no v1 import paths reachable from kernel build graph"
    - "canonical lint: docs/canonical/ free of v1 stage taxonomy, legacy operator labels, broken links"
contracts:
  - type: project_setup
    path: .caws/working-spec.yaml
    description: >-
      Project-level CAWS configuration. Feature-specific contracts will be added
      as features are developed.
  - type: architecture
    path: docs/architecture/roadmap_v0_spine.md
    description: "Milestone roadmap M0-M7 (ephemeral — lives in docs/ephemeral/roadmaps/)"
  - type: policy
    path: docs/policy/doc_authority_policy.md
    description: "Required authority front-matter field for all non-reference docs"
observability:
  logs: []
  metrics: []
  traces:
    - "ByteTrace (canonical persisted trace for replay verification)"
migrations: []
rollback: []
ai_assessment:
  confidence_level: 0.8
  uncertainty_areas:
    - "kernel language choice (Python first, Rust eventually)"
    - "v1 code reuse decisions deferred to M7 checkpoint"
  complexity_factors:
    - "compilation boundary must be deterministic across machines"
    - "schema-first artifact design (schemas define truth, not code)"
  risk_factors:
    - "v1 semantic leakage into v2 canonical surfaces"
    - "doc authority regime drift without CI enforcement"
